@model IEnumerable<SoftAML_UpperLinkAPI.Models.transaction_information_uploads_model>
@{
    ViewBag.Title = "Transaction Information Uploads";
    Layout = "~/Areas/UploadView/Views/Shared/_Layout.cshtml";
}

@section Style{
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.4/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.9/css/responsive.dataTables.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.2.2/css/buttons.dataTables.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/fixedheader/3.1.8/css/fixedHeader.dataTables.min.css" />
}

<div class="page-content">

    <!-- END SAMPLE PORTLET CONFIGURATION MODAL FORM-->
    <!-- BEGIN PAGE HEADER-->
    <h3 class="page-title">
        Transaction Information <small>Uploaded Transaction Information</small>
    </h3>
    <div class="page-bar">
        <ul class="page-breadcrumb">
            <li>
                <i class="fa fa-home"></i>
                <a href="#">Home</a>
                <i class="fa fa-angle-right"></i>
            </li>
            <li>
                <a href="#">Transaction Information</a>
                <i class="fa fa-angle-right"></i>
            </li>
            <li>
                <a href="#">Uploads</a>
            </li>
        </ul>
        <div class="page-toolbar">
            <div class="btn-group pull-right">
                @*<button type="button" class="btn btn-fit-height grey-salt dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-delay="1000" data-close-others="true">
                        Actions <i class="fa fa-angle-down"></i>
                    </button>
                    <ul class="dropdown-menu pull-right" role="menu">
                        <li>
                            <a href="#">Action</a>
                        </li>
                        <li>
                            <a href="#">Another action</a>
                        </li>
                        <li>
                            <a href="#">Something else here</a>
                        </li>
                        <li class="divider">
                        </li>
                        <li>
                            <a href="#">Separated link</a>
                        </li>
                    </ul>*@
            </div>
        </div>
    </div>
    <!-- END PAGE HEADER-->
    <!-- BEGIN PAGE CONTENT-->
    <div class="row">
        <div class="col-md-12">
            <!-- BEGIN SAMPLE TABLE PORTLET-->
            <div class="portlet box blue">
                <div class="portlet-title">
                    <div class="caption">
                        <i class="fa fa-cogs"></i>Transaction Information
                    </div>
                    <div class="tools">
                        <a href="javascript:;" class="collapse">
                        </a>
                        <a href="javascript:;" id="btnReload" class="reload">
                        </a>
                        @*<a href="javascript:;" class="remove">
                            </a>*@
                    </div>
                </div>
                <div class="portlet-body">
                    <div class="table-scrollable">
                        <table class="table table-hover" id="tbl">
                            <thead>
                                <tr>
                                    <th>
                                        @Html.DisplayNameFor(model => model.batch_number)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.uploaded)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_account_number)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_trans_number)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_location)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.transaction_description)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_date)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_teller)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_authorized)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_late_deposit)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_date_posting)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_value_date)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_transmode_code)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_amount_local)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_source_client_type)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_source_type)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_source_funds_code)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_source_currency_code)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_source_foreign_amount)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_source_exchange_rate)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_source_country)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_source_institution_code)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_source_institution_name)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_source_account_number)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_source_account_name)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_source_person_first_name)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_source_person_last_name)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_source_entity_name)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_dest_client_type)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_dest_type)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_dest_funds_code)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_dest_currency_code)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_dest_foreign_amount)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_dest_exchange_rate)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_dest_country)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_dest_institution_code)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_dest_institution_name)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_dest_account_number)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_dest_account_name)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_dest_person_first_name)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_dest_person_last_name)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.t_dest_entity_name)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.Tran_Type)
                                    </th>
                                    <th>
                                        @Html.DisplayNameFor(model => model.uploader)
                                    </th>
                                </tr>
                            </thead>

                        </table>
                    </div>
                </div>
            </div>
            <!-- END SAMPLE TABLE PORTLET-->
        </div>

    </div>

    <!-- END PAGE CONTENT-->
</div>
@section Scripts
{
    <script src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/fixedheader/3.1.5/js/dataTables.fixedHeader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.25.1/moment.min.js"></script>


    <script>
        $(document).ready(function () {

            $('#btnReload').click(function () {

                refnos = [];
                transactions.ajax.reload(null, false);

            });

            var transactions = $("#tbl").DataTable({
                "info": true,
                'responsive': true,
                'destroy': true,
                "orderCellsTop": true,
                "fixedHeader": true,
                'autoWidth': false,
                dom: 'Blfrtip',
                sDom: 'Bfrtip',
                // Design Assets
                stateSave: true,
                autoWidth: true,
                // ServerSide Setups
                processing: true,
                serverSide: true,
                // Paging Setups
                paging: true,
                // Searching Setups
                searching: { regex: true },
                // Ajax Filter
                ajax: {
                    url: "/api/Datatables/LoadTransactionInformation",
                    beforeSend: function (request) {
                        request.setRequestHeader("API_KEY", "BD8E6266F7A847A7B7D8046AA3A64823");
                    },
                    type: "POST",
                    contentType: "application/json",
                    dataType: "json",
                    data: function (d) {
                        return JSON.stringify(d);
                    }
                },
                // Columns Setups
                columns: [
                    { data: "batch_number" },
                    { data: "uploaded" },
                    { data: "t_account_number" },
                    { data: "t_trans_number" },
                    { data: "t_location" },
                    { data: "transaction_description" },
                    {
                        data: "t_date",
                        render: function (data, type, row) {
                            // If display or filter data is requested, format the date
                            if (type === "display" || type === "filter") {
                                return moment(data).format("ddd DD/MM/YYYY HH:mm:ss");
                            }
                            // Otherwise the data type requested (`type`) is type detection or
                            // sorting data, for which we want to use the raw date value, so just return
                            // that, unaltered
                            return data;
                        }
                    },
                    { data: "t_teller" },
                    { data: "t_authorized" },
                    { data: "t_late_deposit" },
                    {
                        data: "t_date_posting",
                        render: function (data, type, row) {
                            // If display or filter data is requested, format the date
                            if (type === "display" || type === "filter") {
                                return moment(data).format("ddd DD/MM/YYYY HH:mm:ss");
                            }
                            // Otherwise the data type requested (`type`) is type detection or
                            // sorting data, for which we want to use the raw date value, so just return
                            // that, unaltered
                            return data;
                        }
                    },
                    {
                        data: "t_value_date",
                        render: function (data, type, row) {
                            // If display or filter data is requested, format the date
                            if (type === "display" || type === "filter") {
                                return moment(data).format("ddd DD/MM/YYYY HH:mm:ss");
                            }
                            // Otherwise the data type requested (`type`) is type detection or
                            // sorting data, for which we want to use the raw date value, so just return
                            // that, unaltered
                            return data;
                        }
                    },
                    { data: "t_transmode_code" },
                    { data: "t_amount_local" },
                    { data: "t_source_client_type" },
                    { data: "t_source_type" },
                    { data: "t_source_funds_code" },
                    { data: "t_source_currency_code" },
                    { data: "t_source_foreign_amount" },
                    { data: "t_source_exchange_rate" },
                    { data: "t_source_country" },
                    { data: "t_source_institution_code" },
                    { data: "t_source_institution_name" },
                    { data: "t_source_account_number" },
                    { data: "t_source_account_name" },
                    { data: "t_source_person_first_name" },
                    { data: "t_source_person_last_name" },
                    { data: "t_source_entity_name" },
                    { data: "t_dest_client_type" },
                    { data: "t_dest_type" },
                    { data: "t_dest_funds_code" },
                    { data: "t_dest_currency_code" },
                    { data: "t_dest_foreign_amount" },
                    { data: "t_dest_exchange_rate" },
                    { data: "t_dest_country" },
                    { data: "t_dest_institution_code" },
                    { data: "t_dest_institution_name" },
                    { data: "t_dest_account_number" },
                    { data: "t_dest_account_name" },
                    { data: "t_dest_person_first_name" },
                    { data: "t_dest_person_last_name" },
                    { data: "t_dest_entity_name" },
                    { data: "Tran_Type" }
                ],
                // Column Definitions
                columnDefs: [
                    { targets: "no-sort", orderable: false },
                    { targets: "no-search", searchable: false },
                    {
                        targets: "trim",
                        render: function (data, type, full, meta) {
                            if (type === "display") {
                                data = strtrunc(data, 10);
                            }

                            return data;
                        }
                    },
                    { targets: "date-type", type: "date-eu" }
                ]
            });
        });

        function strtrunc(str, num) {
            if (str.length > num) {
                return str.slice(0, num) + "...";
            }
            else {
                return str;
            }
        }
    </script>
}

